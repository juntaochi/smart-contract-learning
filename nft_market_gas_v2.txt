No files changed, compilation skipped
Warning: Replayed invariant failure from "/Users/jac/Repos/smart-contract-learning/cache/invariant/failures/NFTMarketOptimizedTest/invariant_MarketHasNoTokenBalance" file. 
Run `forge clean` or remove file to ignore failure and to continue invariant test campaign.

Ran 17 tests for test/NFTMarketOptimized.t.sol:NFTMarketOptimizedTest
[FAIL: invariant_MarketHasNoTokenBalance replay failure]
	[Sequence] (original: 1, shrunk: 1)
		sender=0xF62849F9A0B5Bf2913b396098F7c7019b51A820a addr=[contracts/ERC20WithCallbackAndData.sol:ERC20WithCallbackAndData]0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f calldata=mint(uint256) args=[542502007761677292427982556949926260880397174597049339062567962 [5.425e62]]
 invariant_MarketHasNoTokenBalance() (runs: 1, calls: 1, reverts: 1)
[PASS] testFuzz_Buy_RandomAddress(uint256) (runs: 256, μ: 365854, ~: 365661)
[PASS] testFuzz_ListAndBuy_RandomPrice(uint256) (runs: 256, μ: 335132, ~: 335344)
[PASS] testFuzz_ListAndBuy_RandomPriceAndAddress(uint256,uint256) (runs: 256, μ: 369712, ~: 369696)
[PASS] test_BuyNFT_Fail_AlreadySold() (gas: 395590)
[PASS] test_BuyNFT_Fail_BuyOwnNFT() (gas: 300745)
[PASS] test_BuyNFT_Fail_InsufficientPayment() (gas: 261456)
[PASS] test_BuyNFT_Fail_NotListed() (gas: 41424)
[PASS] test_BuyNFT_Success() (gas: 390255)
[PASS] test_BuyWithCallback_Fail_InsufficientPayment() (gas: 238295)
[PASS] test_BuyWithCallback_RefundsExcess() (gas: 294025)
[PASS] test_Delist_Fail_NotSeller() (gas: 198596)
[PASS] test_Delist_Success() (gas: 255701)
[PASS] test_List_Fail_NotApproved() (gas: 47301)
[PASS] test_List_Fail_NotOwner() (gas: 40783)
[PASS] test_List_Fail_ZeroPrice() (gas: 87774)
[PASS] test_List_Success() (gas: 190576)
Suite result: FAILED. 16 passed; 1 failed; 0 skipped; finished in 40.31ms (135.50ms CPU time)

╭--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------╮
| contracts/ERC20WithCallbackAndData.sol:ERC20WithCallbackAndData Contract |                 |       |        |        |         |
+================================================================================================================================+
| Deployment Cost                                                          | Deployment Size |       |        |        |         |
|--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------|
| 820265                                                                   | 3826            |       |        |        |         |
|--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------|
|                                                                          |                 |       |        |        |         |
|--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------|
| Function Name                                                            | Min             | Avg   | Median | Max    | # Calls |
|--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------|
| approve                                                                  | 46159           | 46179 | 46183  | 46183  | 773     |
|--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------|
| balanceOf                                                                | 2534            | 2534  | 2534   | 2534   | 264     |
|--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------|
| mint                                                                     | 29485           | 29485 | 29485  | 29485  | 1       |
|--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------|
| transfer                                                                 | 51417           | 51547 | 51525  | 51669  | 547     |
|--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------|
| transferWithCallback                                                     | 63294           | 89185 | 89185  | 115077 | 2       |
╰--------------------------------------------------------------------------+-----------------+-------+--------+--------+---------╯

╭--------------------------------------------------------------+-----------------+--------+--------+--------+---------╮
| contracts/NFTMarketOptimized.sol:NFTMarketOptimized Contract |                 |        |        |        |         |
+=====================================================================================================================+
| Deployment Cost                                              | Deployment Size |        |        |        |         |
|--------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| 1558263                                                      | 8104            |        |        |        |         |
|--------------------------------------------------------------+-----------------+--------+--------+--------+---------|
|                                                              |                 |        |        |        |         |
|--------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| Function Name                                                | Min             | Avg    | Median | Max    | # Calls |
|--------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| buyNFT                                                       | 28632           | 100888 | 99641  | 104441 | 774     |
|--------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| delist                                                       | 28741           | 49315  | 49315  | 69889  | 2       |
|--------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| getListing                                                   | 7424            | 7424   | 7424   | 7424   | 3       |
|--------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| list                                                         | 22720           | 110848 | 111171 | 111171 | 780     |
╰--------------------------------------------------------------+-----------------+--------+--------+--------+---------╯

╭------------------------------------------------------------+-----------------+--------+--------+--------+---------╮
| contracts/YangmingGardenNFT.sol:YangmingGardenNFT Contract |                 |        |        |        |         |
+===================================================================================================================+
| Deployment Cost                                            | Deployment Size |        |        |        |         |
|------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| 1302386                                                    | 6026            |        |        |        |         |
|------------------------------------------------------------+-----------------+--------+--------+--------+---------|
|                                                            |                 |        |        |        |         |
|------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| Function Name                                              | Min             | Avg    | Median | Max    | # Calls |
|------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| approve                                                    | 48673           | 48673  | 48673  | 48673  | 778     |
|------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| getApproved                                                | 2817            | 2817   | 2817   | 2817   | 778     |
|------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| isApprovedForAll                                           | 2801            | 2801   | 2801   | 2801   | 1       |
|------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| ownerOf                                                    | 2616            | 2616   | 2616   | 2616   | 1550    |
|------------------------------------------------------------+-----------------+--------+--------+--------+---------|
| safeMint                                                   | 118311          | 118311 | 118311 | 118311 | 17      |
╰------------------------------------------------------------+-----------------+--------+--------+--------+---------╯


Ran 1 test suite in 106.99ms (40.31ms CPU time): 16 tests passed, 1 failed, 0 skipped (17 total tests)

Failing tests:
Encountered 1 failing test in test/NFTMarketOptimized.t.sol:NFTMarketOptimizedTest
[FAIL: invariant_MarketHasNoTokenBalance replay failure]
	[Sequence] (original: 1, shrunk: 1)
		sender=0xF62849F9A0B5Bf2913b396098F7c7019b51A820a addr=[contracts/ERC20WithCallbackAndData.sol:ERC20WithCallbackAndData]0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f calldata=mint(uint256) args=[542502007761677292427982556949926260880397174597049339062567962 [5.425e62]]
 invariant_MarketHasNoTokenBalance() (runs: 1, calls: 1, reverts: 1)

Encountered a total of 1 failing tests, 16 tests succeeded

Tip: Run `forge test --rerun` to retry only the 1 failed test
